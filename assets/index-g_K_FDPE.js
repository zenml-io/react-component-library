import{r as i}from"./index-OjgoNOWw.js";import{j as h}from"./jsx-runtime-DtaoT6pD.js";import{r as M}from"./index-mQqIOHEI.js";import{u as g}from"./index-RGAjXU04.js";import{a as S}from"./index-R7V_VaZ-.js";function L(e,n,{checkForDefaultPrevented:t=!0}={}){return function(r){if(e==null||e(r),t===!1||!r.defaultPrevented)return n==null?void 0:n(r)}}function b(e,n=[]){let t=[];function s(m,a){const u=i.createContext(a),c=t.length;t=[...t,a];function o(f){const{scope:d,children:N,...x}=f,P=(d==null?void 0:d[e][c])||u,O=i.useMemo(()=>x,Object.values(x));return h.jsx(P.Provider,{value:O,children:N})}function p(f,d){const N=(d==null?void 0:d[e][c])||u,x=i.useContext(N);if(x)return x;if(a!==void 0)return a;throw new Error(`\`${f}\` must be used within \`${m}\``)}return o.displayName=m+"Provider",[o,p]}const r=()=>{const m=t.map(a=>i.createContext(a));return function(u){const c=(u==null?void 0:u[e])||m;return i.useMemo(()=>({[`__scope${e}`]:{...u,[e]:c}}),[u,c])}};return r.scopeName=e,[s,l(r,...n)]}function l(...e){const n=e[0];if(e.length===1)return n;const t=()=>{const s=e.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(m){const a=s.reduce((u,{useScope:c,scopeName:o})=>{const f=c(m)[`__scope${o}`];return{...u,...f}},{});return i.useMemo(()=>({[`__scope${n.scopeName}`]:a}),[a])}};return t.scopeName=n.scopeName,t}function C(e,n){return i.useReducer((t,s)=>n[t][s]??t,e)}var R=e=>{const{present:n,children:t}=e,s=T(n),r=typeof t=="function"?t({present:s.isPresent}):i.Children.only(t),m=g(s.ref,E(r));return typeof t=="function"||s.isPresent?i.cloneElement(r,{ref:m}):null};R.displayName="Presence";function T(e){const[n,t]=i.useState(),s=i.useRef({}),r=i.useRef(e),m=i.useRef("none"),a=e?"mounted":"unmounted",[u,c]=C(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return i.useEffect(()=>{const o=A(s.current);m.current=u==="mounted"?o:"none"},[u]),S(()=>{const o=s.current,p=r.current;if(p!==e){const d=m.current,N=A(o);e?c("MOUNT"):N==="none"||(o==null?void 0:o.display)==="none"?c("UNMOUNT"):c(p&&d!==N?"ANIMATION_OUT":"UNMOUNT"),r.current=e}},[e,c]),S(()=>{if(n){const o=f=>{const N=A(s.current).includes(f.animationName);f.target===n&&N&&M.flushSync(()=>c("ANIMATION_END"))},p=f=>{f.target===n&&(m.current=A(s.current))};return n.addEventListener("animationstart",p),n.addEventListener("animationcancel",o),n.addEventListener("animationend",o),()=>{n.removeEventListener("animationstart",p),n.removeEventListener("animationcancel",o),n.removeEventListener("animationend",o)}}else c("ANIMATION_END")},[n,c]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:i.useCallback(o=>{o&&(s.current=getComputedStyle(o)),t(o)},[])}}function A(e){return(e==null?void 0:e.animationName)||"none"}function E(e){var s,r;let n=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,t=n&&"isReactWarning"in n&&n.isReactWarning;return t?e.ref:(n=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,t=n&&"isReactWarning"in n&&n.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}export{R as P,L as a,b as c};
