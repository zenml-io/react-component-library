import{r as s}from"./index-OjgoNOWw.js";import{a as v,$ as p}from"./index-aLhqFf3u.js";import{r as A}from"./index-mQqIOHEI.js";import{a as h}from"./index-uxD8nXqh.js";function g(e,n,{checkForDefaultPrevented:c=!0}={}){return function(o){if(e==null||e(o),c===!1||!o.defaultPrevented)return n==null?void 0:n(o)}}function I({prop:e,defaultProp:n,onChange:c=()=>{}}){const[t,o]=b({defaultProp:n,onChange:c}),a=e!==void 0,m=a?e:t,f=v(c),i=s.useCallback(r=>{if(a){const u=typeof r=="function"?r(e):r;u!==e&&f(u)}else o(r)},[a,e,o,f]);return[m,i]}function b({defaultProp:e,onChange:n}){const c=s.useState(e),[t]=c,o=s.useRef(t),a=v(n);return s.useEffect(()=>{o.current!==t&&(a(t),o.current=t)},[t,o,a]),c}function P(e,n){return s.useReducer((c,t)=>{const o=n[c][t];return o??c},e)}const M=e=>{const{present:n,children:c}=e,t=O(n),o=typeof c=="function"?c({present:t.isPresent}):s.Children.only(c),a=h(t.ref,o.ref);return typeof c=="function"||t.isPresent?s.cloneElement(o,{ref:a}):null};M.displayName="Presence";function O(e){const[n,c]=s.useState(),t=s.useRef({}),o=s.useRef(e),a=s.useRef("none"),m=e?"mounted":"unmounted",[f,i]=P(m,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return s.useEffect(()=>{const r=N(t.current);a.current=f==="mounted"?r:"none"},[f]),p(()=>{const r=t.current,d=o.current;if(d!==e){const $=a.current,l=N(r);e?i("MOUNT"):l==="none"||(r==null?void 0:r.display)==="none"?i("UNMOUNT"):i(d&&$!==l?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,i]),p(()=>{if(n){const r=u=>{const l=N(t.current).includes(u.animationName);u.target===n&&l&&A.flushSync(()=>i("ANIMATION_END"))},d=u=>{u.target===n&&(a.current=N(t.current))};return n.addEventListener("animationstart",d),n.addEventListener("animationcancel",r),n.addEventListener("animationend",r),()=>{n.removeEventListener("animationstart",d),n.removeEventListener("animationcancel",r),n.removeEventListener("animationend",r)}}else i("ANIMATION_END")},[n,i]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:s.useCallback(r=>{r&&(t.current=getComputedStyle(r)),c(r)},[])}}function N(e){return(e==null?void 0:e.animationName)||"none"}export{g as $,M as a,I as b};
